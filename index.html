<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simple TTS Web App</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#9aa4b2;--accent:#6ee7b7}
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center; background:linear-gradient(180deg,#071029 0%, #071726 100%); color:#e6eef6}
    .wrap{width:960px; max-width:96%; padding:28px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border-radius:14px; box-shadow:0 8px 30px rgba(2,6,23,0.6)}
    h1{margin:0 0 10px 0; font-size:20px}
    p.lead{margin:0 0 18px 0; color:var(--muted); font-size:14px}
    .grid{display:grid; grid-template-columns:1fr 320px; gap:18px}
    textarea{width:100%; min-height:240px; resize:vertical; background:#021024; border:1px solid rgba(255,255,255,0.04); color:inherit; padding:12px; border-radius:8px; font-size:15px}
    .controls{display:flex; flex-direction:column; gap:12px}
    label{font-size:13px; color:var(--muted)}
    select,input[type=range]{width:100%; margin-top:6px}
    .row{display:flex; gap:8px}
    button{appearance:none; border:0; background:linear-gradient(90deg,var(--accent),#10b981); color:#022; font-weight:600; padding:10px 12px; border-radius:8px; cursor:pointer}
    button.secondary{background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted); font-weight:600}
    .meta{font-size:12px; color:var(--muted)}
    footer{margin-top:14px; font-size:12px; color:var(--muted)}
    .small{font-size:12px}
    @media (max-width:880px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Simple TTS Web App</h1>
    <p class="lead">Type (or paste) text, choose a voice, adjust rate &amp; pitch, then press <strong>Speak</strong>. Works in modern browsers that implement the Web Speech API (Chrome, Edge, Safari, Firefox may vary).</p>

    <div class="grid">
      <div>
        <label class="small" for="text">Text to speak</label>
        <textarea id="text">Hello! This is a simple text-to-speech demo. Try changing the voice, rate, or pitch.</textarea>

        <div style="display:flex; gap:8px; margin-top:10px">
          <button id="speak">Speak ▶</button>
          <button class="secondary" id="pause">Pause ⏸</button>
          <button class="secondary" id="resume">Resume ►</button>
          <button class="secondary" id="stop">Stop ■</button>
        </div>

        <p class="meta">Tip: press <strong>Ctrl/⌘ + Enter</strong> to start speaking quickly.</p>
      </div>

      <aside class="controls">
        <div>
          <label for="voices">Voice</label>
          <select id="voices" aria-label="Choose voice"></select>
        </div>

        <div>
          <label for="rate">Rate: <span id="rateValue">1</span></label>
          <input id="rate" type="range" min="0.5" max="2" step="0.1" value="1">
        </div>

        <div>
          <label for="pitch">Pitch: <span id="pitchValue">1</span></label>
          <input id="pitch" type="range" min="0" max="2" step="0.1" value="1">
        </div>

        <div>
          <label for="volume">Volume: <span id="volumeValue">1</span></label>
          <input id="volume" type="range" min="0" max="1" step="0.1" value="1">
        </div>

        <div>
          <label>Actions</label>
          <div class="row">
            <button id="copy" class="secondary">Copy Text</button>
            <button id="clear" class="secondary">Clear</button>
          </div>
        </div>

        <div>
          <label>Status</label>
          <div class="small" id="status">Idle</div>
        </div>
      </aside>
    </div>

    <footer>
      Note: Browsers implement TTS differently. Downloading synthesized audio directly from SpeechSynthesis is not supported by the standard. For exporting audio you need a server-side TTS or cloud TTS provider (Google, Azure, Amazon) or record via an external virtual audio device.
    </footer>
  </div>

  <script>
    // Elements
    const textEl = document.getElementById('text');
    const voicesEl = document.getElementById('voices');
    const rateEl = document.getElementById('rate');
    const pitchEl = document.getElementById('pitch');
    const volumeEl = document.getElementById('volume');
    const speakBtn = document.getElementById('speak');
    const pauseBtn = document.getElementById('pause');
    const resumeBtn = document.getElementById('resume');
    const stopBtn = document.getElementById('stop');
    const copyBtn = document.getElementById('copy');
    const clearBtn = document.getElementById('clear');
    const statusEl = document.getElementById('status');
    const rateValue = document.getElementById('rateValue');
    const pitchValue = document.getElementById('pitchValue');
    const volumeValue = document.getElementById('volumeValue');

    let synth = window.speechSynthesis;
    let currentUtterance = null;

    function setStatus(s){ statusEl.textContent = s }

    // Populate voices
    function populateVoices(){
      const voices = synth.getVoices();
      voicesEl.innerHTML = '';
      voices.forEach((v, i) => {
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = `${v.name} — ${v.lang}${v.default ? ' (default)' : ''}${v.localService ? '' : ' (remote)'}`;
        voicesEl.appendChild(opt);
      });
    }

    populateVoices();
    if (speechSynthesis.onvoiceschanged !== undefined) {
      speechSynthesis.onvoiceschanged = populateVoices;
    }

    function speak(){
      if (!synth) return alert('SpeechSynthesis not supported in this browser');
      if (synth.speaking) {
        setStatus('Already speaking');
        return;
      }
      const txt = textEl.value.trim();
      if (!txt) return setStatus('No text to speak');

      currentUtterance = new SpeechSynthesisUtterance(txt);
      const voices = synth.getVoices();
      const chosen = voices[voicesEl.value] || voices[0];
      if (chosen) currentUtterance.voice = chosen;
      currentUtterance.rate = parseFloat(rateEl.value);
      currentUtterance.pitch = parseFloat(pitchEl.value);
      currentUtterance.volume = parseFloat(volumeEl.value);

      currentUtterance.onstart = () => setStatus('Speaking');
      currentUtterance.onend = () => { setStatus('Finished'); currentUtterance = null };
      currentUtterance.onerror = (e) => { console.error(e); setStatus('Error'); };

      // Optional: show boundary events (word/char)
      currentUtterance.onboundary = (ev) => {
        // could highlight word/char here
      };

      synth.speak(currentUtterance);
    }

    function pause(){
      if (synth && synth.speaking && !synth.paused){
        synth.pause(); setStatus('Paused');
      }
    }
    function resume(){
      if (synth && synth.paused){ synth.resume(); setStatus('Resumed'); }
    }
    function stop(){
      if (synth){ synth.cancel(); setStatus('Stopped'); currentUtterance = null }
    }

    // Controls
    speakBtn.addEventListener('click', speak);
    pauseBtn.addEventListener('click', pause);
    resumeBtn.addEventListener('click', resume);
    stopBtn.addEventListener('click', stop);
    copyBtn.addEventListener('click', ()=>{ navigator.clipboard?.writeText(textEl.value).then(()=>setStatus('Copied text'),()=>setStatus('Copy failed')) });
    clearBtn.addEventListener('click', ()=>{ textEl.value=''; setStatus('Cleared') });

    rateEl.addEventListener('input', ()=>{ rateValue.textContent = rateEl.value });
    pitchEl.addEventListener('input', ()=>{ pitchValue.textContent = pitchEl.value });
    volumeEl.addEventListener('input', ()=>{ volumeValue.textContent = volumeEl.value });

    // Keyboard shortcut Ctrl/Cmd + Enter
    textEl.addEventListener('keydown', (e)=>{
      if ((e.ctrlKey || e.metaKey) && e.key === 'Enter'){
        e.preventDefault(); speak();
      }
    });

    // On page unload, cancel any speech
    window.addEventListener('beforeunload', ()=>{ if (synth) synth.cancel() });

    // Feature detection message
    if (!('speechSynthesis' in window)){
      setStatus('SpeechSynthesis API not supported in this browser');
    } else {
      setStatus('Ready');
    }
  </script>
</body>
</html>
